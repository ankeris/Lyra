{% extends "layouts/default.html" %}

{% block head %}
	<title>{{globaldata.titles.products}}</title>
{% endblock %}

{% block intro %}
	{% set title = ( data.category.name if data.category else "Produktai" ) %}
    <div class="title">
        <h3>{{ title }}</h3>
    </div>
{% endblock %}

{% block content %}

{% include 'partials/search.html' %}

{% include 'partials/sort.html' %}

<div class="products-wrapper content-section">
    {% if data.categories.length %}
        <aside class="side-nav">
                {% set class = ( "active" if not data.category else "" ) %}
                {# {% set hasSubCategories = ( "navigation-dropdown" if. . . else "" ) %} #}
                <div class="manufacturers-dropdown navigation-dropdown">
                    Gamintojai
                    <img src="/images/dropdown.svg" alt="" class="dropdownSVG">
                </div>
                <section class="subcategory-box" style="display: none;">
                {% for manufacturer in manufacturers %}
                    <a href="/brands/{{manufacturer.key}}" class="subcategory-box__item">
                        {{manufacturer.name}}
                    </a>
                {% endfor %}
                </section>
                <a href="/products" class="{{ class }} side-nav__list-box--item">Visi produktai</a>
                {% for cat in data.categories %} {% set class = ( "active" if data.category and data.category.id == cat.id else "" ) %}
                    <a href="/products/{{ cat.key }}" class="{{ class }} side-nav__list-box--item">{{ cat.name }}
                    <small>{{cat.postCount}}</small></a>
                {% endfor %}
        </aside>
    {% endif %}
    {# items box wrapper #}
    <section class="products">
            {# looping through products #}
            {% for product in data.products.results %}
            {# product variables #}
            {% set manufacturerKey = product.Manufacturer.key %}
            {% set manufacturerName = product.Manufacturer.name %}
            {% set productTypeKey = product.ProductType[0].key %}

            <div class="items-box__item fade-in appear">
            <a href="/products/{{manufacturerKey}}/{{productTypeKey}}/{{product.slug}}">
                <div manufacturer="{{manufacturerName}}">
                    {% if product.images %}
                        {# Main image #}
                        <div class="items-box__item--main-image" style="background-image: url('{{product.images[0].secure_url}}')">
                        </div>
                    {% endif %}
                </div>
            </a>
            <p class="items-box__item--description">{{product.title}} - {{manufacturerName}} <br>{{product.price}}â‚¬</p>
            </div>
            {% endfor %}
    </section>
    {# Loading screen for products #}
    <figure id="loading-content" class="canvas canvas6">
        <div class="spinner6 p1"></div>
        <div class="spinner6 p2"></div>
        <div class="spinner6 p3"></div>
        <div class="spinner6 p4"></div>
    </figure>
</div>

<div class="variables" data-sort="{{data.sort}}" data-category="{{data.category.key}}" data-count="{{data.products.results.length}}"></div>
<script src="/js/jquery/jquery-1.11.3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
<script src="/js/manual/loadmore.js"></script>

{% endblock %}